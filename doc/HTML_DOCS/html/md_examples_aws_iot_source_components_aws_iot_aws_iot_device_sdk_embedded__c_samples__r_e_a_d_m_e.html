<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESP32 Quick Start Building Blocks: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="2" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ESP32 Quick Start Building Blocks
   </div>
   <!-- PROJECT BRIEF is expected to be a URL -->
   <div id="projectbrief"><a href=https://github.com/IoTReady/esp32_firmware_base>https://github.com/IoTReady/esp32_firmware_base</a></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_examples_aws_iot_source_components_aws_iot_aws_iot_device_sdk_embedded__c_samples__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This folder contains several samples that demonstrate various SDK functions. The Readme file also includes a walk-through of the subscribe publish sample to explain how the SDK is used. The samples are currently provided with Makefiles for building them on linux. For each sample:</p>
<ul>
<li>Explore the makefile. The makefile for each sample provides a reference on how to set up makefiles for client applications</li>
<li>Explore the example. It connects to AWS IoT platform using MQTT and demonstrates few actions that can be performed by the SDK</li>
<li>Download certificate authority CA file from <a href="https://www.symantec.com/content/en/us/enterprise/verisign/roots/VeriSign-Class%203-Public-Primary-Certification-Authority-G5.pem">Symantec</a> and place in location referenced in the example (certs/)</li>
<li>Ensure you have <a href="https://docs.aws.amazon.com/iot/latest/developerguide/create-thing.html">created a thing</a> through your AWS IoT Console with name matching the definition AWS_IOT_MY_THING_NAME in the <code>aws_iot_config.h</code> file</li>
<li>Place device identity cert and private key in locations referenced in the example (certs/)</li>
<li>Ensure the names of the cert files are the same as in the <code>aws_iot_config.h</code> file</li>
<li>Ensure the certificate has an attached policy which allows the proper permissions for AWS IoT</li>
<li>Build the example using make (<code>make</code>)</li>
<li>Run sample application (./subscribe_publish_sample or ./shadow_sample). The sample will print status messages to stdout</li>
<li>All samples are written in C unless otherwise mentioned. The following sample applications are included:<ul>
<li><code>subscribe_publish_sample</code> - a simple pub/sub MQTT example</li>
<li><code>subscribe_publish_cpp_sample</code> - a simple pub/sub MQTT example written in C++</li>
<li><code>subscribe_publish_library_sample</code> - a simple pub/sub MQTT example which builds the SDK as a separate library</li>
<li><code>shadow_sample</code> - a simple device shadow example using a connected window example</li>
<li><code>shadow_sample_console_echo</code> - a sample to work with the AWS IoT Console interactive guide</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md70"></a>
Subscribe Publish Sample</h1>
<p>This is a simple pub/sub MQTT example. It connects a single MQTT client to the server and subscribes to a test topic. Then it proceeds to publish messages on this topic and yields after each publish to ensure that the message was received.</p>
<ul>
<li>The sample first creates an instance of the AWS_IoT_Client</li>
<li>The next step is to initialize the client. The aws_iot_mqtt_init API is called for this purpose. The API takes the client instance and an <a class="el" href="struct_io_t___client___init___params.html" title="MQTT Initialization Parameters.">IoT_Client_Init_Params</a> variable to set the initial values for the client. The Init params include values like host URL, port, certificates, disconnect handler etc.</li>
<li>If the call to the init API was successful, we can proceed to call connect. The API is called aws_iot_mqtt_connect. It takes the client instance and <a class="el" href="struct_io_t___client___connect___params.html" title="MQTT Connection Parameters.">IoT_Client_Connect_Params</a> variable as arguments. The <a class="el" href="struct_io_t___client___connect___params.html" title="MQTT Connection Parameters.">IoT_Client_Connect_Params</a> is optional after the first call to connect as the client retains the original values that were provided to support reconnect. The Connect params include values like Client Id, MQTT Version etc.</li>
<li>If the connect API call was successful, we can proceed to subscribe and publish on this connect. The connect API call will return an error code, specific to the type of error that occurred, in case the call fails.</li>
<li>It is important to remember here that there is no dynamic memory allocation in the SDK. Any values that are passed as a pointer to the APIs should not be freed unless they are not required any further. For example, if the variable that stores the certificate path is freed after the init call is made, the connect call will fail. Similarly, if it is freed after the connect API returns success, any future connect calls (including reconnects) will fail.</li>
<li>The next step for this sample is to subscribe to the test topic. The API to be called for subscribe is aws_iot_mqtt_subscribe. It takes as arguments, the IoT Client instance, topic name, the length of the topic name, QoS, the subscribe callback handler and an optional pointer to some data to be returned to the subscribe handler</li>
<li>The next step it to call the publish API to send a message on the test topic. The sample sends two different messages, one QoS0 and one QoS1. The</li>
<li>The publish API takes the client instance, topic name to publish to, topic name length and a variable of type <a class="el" href="struct_io_t___publish___message___params.html" title="Publish Message Parameters Type.">IoT_Publish_Message_Params</a>. The <a class="el" href="struct_io_t___publish___message___params.html" title="Publish Message Parameters Type.">IoT_Publish_Message_Params</a> contains the payload, length of the payload and QoS.</li>
<li>If the publish API calls are successful, the sample proceeds to call the yield API. The yield API takes the client instance and a timeout value in milliseconds as arguments.</li>
<li>The yield API is called to let the SDK process any incoming messages. It also periodically sends out the PING request to prevent disconnect and, if enabled, it also performs auto-reconnect and resubscribe.</li>
<li>The yield API should be called periodically to process the PING request as well as read any messages in the receive buffer. It should be called once at least every TTL/2 time periods to ensure disconnect does not happen. There can only be one yield in progress at a time. Therefore, in multi-threaded scenarios one thread can be a dedicated yield thread while other threads handle other operations.</li>
<li>The sample sends out messages equal to the value set in publish count unless infinite publishing flag is set</li>
</ul>
<p>For further information on each API please read the API documentation.</p>
<h1><a class="anchor" id="autotoc_md71"></a>
Subscribe Publish Cpp Sample</h1>
<p>This is the same sample as above but it is built using a C++ compiler. It demonstrates how the SDK can be used in a C++ program.</p>
<h1><a class="anchor" id="autotoc_md72"></a>
Subscribe Publish Library Sample</h1>
<p>This is also the same code as the Subscribe Publish sample. In this case, the SDK is built as a separate library and then used in the sample program. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://iotready.co"> IoTReady </a><img class="footer" src="logo.png" width="30" height="30" alt="IoTReady"/></a></li>
  </ul>
</div>
</body>
</html>
